<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eluun - Official</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Main container -->
    <div class="container">
        <!-- Profile Section -->
        <div class="profile">
            <img src="profile.png" alt="Eluun" class="profile-pic">
            <h1 class="artist-name">Eluun</h1>
        </div>

        <!-- Subscription Form -->
        <div class="form-container">
            <h2>Give your strongest support to my independence</h2>
            <form id="phone-form">
                <p class="content-text">Today's music world is terribly hard on independent, non-mainstream and underground artists. Dependence on algorithms is a veritable plague that is slowly killing our industry. This is the observation I make every day as a player in this industry.
                  <br><br>
                  That's why I want to take strong action and stop putting my trust in platforms like Spotify ou Instagram, which severely limit the support you want to give me by profoundly limiting my visibility.
                  <br><br>
                  I've been looking for an alternative solution for a long time, and Discord seems to be the best one.
                  <br>
                  If you'd like to make a difference in your own way, too, and offer me the best (free) support, click on this button and join my discord. I've programmed it to keep you informed of future releases.
                  <br><br>
                  I'll never be able to thank enough the people who decide to sign up here.
                  <br><br>
                  Eluun
                  </p>

                    <a href="/.netlify/functions/discord-auth" target="_blank">
                      <button type="button" id="submit-btn" class="follow-btn discord-btn">
                          <img src="discord-white-icon.webp" alt="Discord Logo" class="discord-logo">
                          Join us
                      </button>
                  </a>

<script>
  function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  }

  window.onload = async () => {
    const userId = getQueryParam('userId');
    if (userId) {
      console.log('User ID:', userId);
      joinDiscord(userId);
    }
  };

  function loginWithDiscord() {
    const clientId = 'YOUR_CLIENT_ID'; // Remplacez par votre client_id Discord
    const redirectUri = encodeURIComponent('https://votre-site.netlify.app/callback');
    const scope = encodeURIComponent('identify');
    const responseType = 'code';

    const url = `https://discord.com/api/oauth2/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=${responseType}&scope=${scope}`;
    window.location.href = url;
  }

  function joinDiscord(userId) {
    console.log('joinDiscord function called');
    console.log('User ID:', userId);

    const url = `/.netlify/functions/addRole?userId=${userId}`;
    console.log('Fetch URL:', url);

    fetch(url)
      .then(response => {
        console.log('Fetch response received');
        return response.text();
      })
      .then(data => {
        console.log('Response data:', data);
        alert(data);
      })
      .catch(error => {
        console.error('Error:', error);
      });
  }
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const urlParams = new URLSearchParams(window.location.search);
  const code = urlParams.get('code');
  
  if (code) {
    fetch('/.netlify/functions/process-discord', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ code })
    })
    .then(response => {
      // Vérifier si la redirection est nécessaire
      if (response.redirected) {
        window.location.href = response.url;
        return;
      }
      return response.json();
    })
    .then(data => {
      if (data && data.success) {
        window.location.href = '/?success=true';
      }
    })
    .catch(error => {
      console.error('Erreur:', error);
    });
  }

  // Vérifier success pour le modal
  if (urlParams.get('success') === 'true') {
    document.getElementById('thanksModal').style.display = 'flex';
  }
});
</script>
                    
            </form>
    </div>
    
        <h3 class="link-text">All my link :</h3>

        <!-- Button Section -->
        <!-- Début du bloc des boutons -->
<!-- Section des boutons -->
<section class="button-section">
<!-- Première colonne -->
<div class="column">
    <a href="https://www.mbartists.co.uk/clara/eluun" target="_blank"><button>Booking EU/UK</button></a>
    <a href="https://www.patreon.com/c/Eluun" target="_blank"><button>Patreon (support)</button></a>
    <a href="https://www.instagram.com/eluun.dnb/" target="_blank"><button>Instagram</button></a>
    <a href="https://soundcloud.com/eluunofficial" target="_blank"><button>Soundcloud</button></a>
    <a href="https://open.spotify.com/intl-fr/artist/7LySsKIRvri6Ye5kUv47DQ?si=3165a23d26134a30" target="_blank"><button>Spotify</button></a>
    <a href="https://music.apple.com/fr/artist/eluun/1195602750" target="_blank"><button>Apple Music</button></a>
    <!-- <a href="download.html" target="_blank"><button>Free download my music</button></a> reactivé le boutton dl ici-->
  </div>
  
<!-- Deuxième colonne -->
<div class="column">
    <a href="https://bfan.link/soulchild" target="_blank">
        <button>
            Soulchild EP
            <span class="button-icon">
                <img src="Soulchild.jpg" class="icon-pic" />
            </span>
        </button>
    </a>

    <a href="https://kosenprod.fanlink.tv/fromdusttodawn" target="_blank">
        <button>
            Snowfall
            <span class="button-icon">
                <img src="Snowfall.jpg" class="icon-pic" />
            </span>
        </button>
    </a>

    <a href="https://open.spotify.com/intl-fr/album/0Fb4pOQvyLpSb2S8YA4NYs?si=fEh5RrFtR5eugEDestkbHQ&nd=1&dlsi=ddcdd303e43a4367" target="_blank">
        <button>
            Icarus EP
            <span class="button-icon">
                <img src="Icarus.jpg" class="icon-pic" />
            </span>
        </button>
    </a>

    <a href="https://bfan.link/gen-iii" target="_blank">
        <button>
            Unseen
            <span class="button-icon">
                <img src="Unseen.jpg" class="icon-pic" />
            </span>
        </button>
    </a>

    <a href="https://soundcloud.com/eluunofficial/tarantula-bootleg" target="_blank">
        <button>
            Tarantula Bootleg
            <span class="button-icon">
                <img src="Tarantula.jpg" class="icon-pic" />
            </span>
        </button>
    </a>

    <a href="https://soundcloud.com/eluunofficial/buunshin-different-tomorrow-eluun-remix-8" target="_blank">
        <button>
            Different Tomorrow Remix
            <span class="button-icon">
                <img src="Different.jpg" class="icon-pic" />
            </span>
        </button>
    </a>
</div>

<div id="thanksModal" class="modal" style="display: none;">
  <div class="modal-content">
    <p class="modal-text">
      Thank you so much for joining the server. You can't imagine the value of your support. If you want to optimize your help, install discord on your phone, so you can receive notifications when I release new music and be 100% sure not to miss them and therefore support me in the best way possible.
      <br><br>
      Beyond that, you can also chat with us and become an integral part of the community!
      <br><br>
      <!--One last step, click on the button below to set up your notifications and avoid receiving them for every message shared on the server.
      <br><br>-->
      Thanks a million.
      <br>
      Mona
    </p>
    <div class="modal-buttons">
      <button class="discord-btn" onclick="window.open('https://discord.com/channels/1174313475552591933/1174313478660575302', '_blank')">
        <img src="discord-white-icon.webp" alt="Discord" />
        Go to the server
      </button>
      <button class="return-btn" onclick="closeModal()">Return</button>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('success')) {
    document.getElementById('thanksModal').style.display = 'flex';
  }
});


function closeModal() {
  document.getElementById('thanksModal').style.display = 'none';
  window.history.replaceState({}, document.title, '/');
}
</script>

</body>
</html>
